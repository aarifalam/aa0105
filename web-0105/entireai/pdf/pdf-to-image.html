<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">

<title>PDF to Image Converter Online Free – EntireAI</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<meta name="description" content="Convert PDF to JPG, PNG images online for free using EntireAI. Instantly extract high-quality images from your PDF files with full security.">

<meta name="keywords" content="pdf to image, pdf to jpg online, pdf to png free, convert pdf to images, extract images from pdf, entireai pdf">

<meta name="author" content="Isaac Ojo">
<meta name="generator" content="Developed by AarifAlam0105">

<meta name="robots" content="index, follow, max-image-preview:large">

<link rel="canonical" href="https://entireai.net/pdf/pdf-to-image">

<!-- Open Graph -->
<meta property="og:type" content="website">
<meta property="og:site_name" content="EntireAI">
<meta property="og:url" content="https://entireai.net/pdf/pdf-to-image">
<meta property="og:title" content="PDF to Image Converter Online Free | EntireAI">
<meta property="og:description" content="Convert PDF pages into high-quality JPG or PNG images instantly using EntireAI’s free PDF to Image tool.">
<meta property="og:image" content="/images/pdf-to-image.jpg">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta property="og:image:alt" content="EntireAI PDF to Image Converter Interface">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="PDF to Image Converter Online Free | EntireAI">
<meta name="twitter:description" content="Convert PDF files to images online for free. No watermark, no signup, instant results with EntireAI.">
<meta name="twitter:image" content="/images/pdf-to-image.jpg">
<meta name="twitter:creator" content="@isaacolojo">

<meta name="theme-color" content="#0f172a">
<meta name="application-name" content="EntireAI PDF to Image">

<!-- WebApplication Schema -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebApplication",
  "name": "EntireAI PDF to Image",
  "url": "https://entireai.net/pdf/pdf-to-image",
  "description": "Free online tool to convert PDF documents into high-quality image files instantly.",
  "applicationCategory": "DocumentUtility",
  "operatingSystem": "All",
  "browserRequirements": "Requires JavaScript",
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "USD",
    "availability": "https://schema.org/InStock"
  },
  "creator": {
    "@type": "Organization",
    "name": "EntireAI",
    "url": "https://entireai.net/"
  }
}
</script>

<!-- Breadcrumb Schema -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://entireai.net/"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "PDF Tools",
      "item": "https://entireai.net/pdf/"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": "PDF to Image",
      "item": "https://entireai.net/pdf/pdf-to-image"
    }
  ]
}
</script>


<!-- Favicon --><link rel="apple-touch-icon" sizes="180x180" href="../images/logo/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="../images/logo/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="../images/logo/favicon-16x16.png"><link rel="manifest" href="/site.webmanifest"><meta name="theme-color" content="#6c5ce7"><link rel="stylesheet" href="css/image-to-pdf-enhance.css">
<link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --primary: #6c5ce7;
            --primary-light: #a29bfe;
            --primary-dark: #4d44db;
            --accent: #fd79a8;
            --success: #00b894;
            --danger: #d63031;
            --light: #f8f9fa;
            --dark: #2d3436;
            --gray: #636e72;
            --white: #ffffff;
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.12);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            --border-radius: 8px;
            --border-radius-lg: 16px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #dfe6f0 100%);
            color: var(--dark);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            line-height: 1.6;
        }

        .pdf-converter {
            width: 100%;
            max-width: 800px;
            background: var(--white);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-lg);
            overflow: hidden;
            transform: translateY(0);
            transition: var(--transition);
            animation: fadeInUp 0.5s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .converter-header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: var(--white);
            padding: 25px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .converter-header h1 {
            font-size: 2rem;
            margin-bottom: 8px;
            position: relative;
            z-index: 1;
            font-weight: 700;
        }

        .converter-header p {
            font-size: 0.95rem;
            opacity: 0.9;
            max-width: 500px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
            font-weight: 300;
        }

        .converter-content {
            padding: 25px;
        }

        .upload-area {
            border: 2px dashed var(--primary-light);
            border-radius: var(--border-radius);
            padding: 30px 20px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            margin-bottom: 20px;
            position: relative;
            background: rgba(162, 155, 254, 0.05);
        }

        .upload-area.highlight {
            border-color: var(--primary);
            background: rgba(162, 155, 254, 0.1);
            transform: translateY(-2px);
            box-shadow: var(--shadow-sm);
        }

        .upload-area i {
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 12px;
            transition: var(--transition);
        }

        .upload-area h3 {
            margin-bottom: 8px;
            color: var(--primary);
            font-weight: 600;
            font-size: 1.1rem;
        }

        .upload-area p {
            color: var(--gray);
            margin-bottom: 0;
            font-size: 0.9rem;
        }

        .upload-area .browse-text {
            color: var(--primary);
            font-weight: 500;
            text-decoration: underline;
        }

        #file-input {
            display: none;
        }

        .options-section {
            margin: 20px 0;
        }

        .options-title {
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--dark);
            font-size: 1rem;
        }

        .option-group {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 15px;
        }

        .option-item {
            flex: 1;
            min-width: 150px;
        }

        .option-item label {
            display: block;
            margin-bottom: 6px;
            font-size: 0.85rem;
            color: var(--dark);
            font-weight: 500;
        }

        .option-item select,
        .option-item input {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid #e0e0e0;
            border-radius: var(--border-radius);
            font-family: 'Poppins', sans-serif;
            transition: var(--transition);
            font-size: 0.9rem;
        }

        .option-item select:focus,
        .option-item input:focus {
            outline: none;
            border-color: var(--primary-light);
            box-shadow: 0 0 0 3px rgba(108, 92, 231, 0.2);
        }

        .checkbox-option {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 10px;
        }

        .checkbox-option input {
            width: auto;
        }

        .checkbox-option label {
            font-size: 0.85rem;
            color: var(--dark);
            cursor: pointer;
        }

        .file-preview {
            margin-top: 20px;
            display: none;
        }

        .preview-title {
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--dark);
            font-size: 1rem;
        }

        .preview-container {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
        }

        .preview-image {
            width: 120px;
            height: 160px;
            border-radius: var(--border-radius);
            overflow: hidden;
            position: relative;
            box-shadow: var(--shadow-sm);
            transition: var(--transition);
        }

        .preview-image:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-md);
        }

        .preview-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .preview-image .page-number {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            text-align: center;
            padding: 3px 0;
            font-size: 0.7rem;
        }

        .action-btns {
            display: flex;
            gap: 12px;
            margin-top: 20px;
        }

        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            flex: 1;
            font-size: 0.9rem;
        }

        .btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }

        .btn-primary {
            background: var(--primary);
            color: var(--white);
            box-shadow: 0 4px 15px rgba(108, 92, 231, 0.3);
        }

        .btn-primary:hover:not(:disabled) {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(108, 92, 231, 0.4);
        }

        .btn-secondary {
            background: var(--white);
            color: var(--primary);
            border: 2px solid var(--primary);
        }

        .btn-secondary:hover:not(:disabled) {
            background: rgba(108, 92, 231, 0.1);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success) 0%, #00a884 100%);
            color: var(--white);
            box-shadow: 0 4px 15px rgba(0, 184, 148, 0.3);
            position: relative;
            overflow: hidden;
            border: none;
        }

        .btn-success:hover::before {
            animation: shine 1.5s infinite;
        }

        @keyframes shine {
            0% {
                left: -100%;
            }
            100% {
                left: 100%;
            }
        }

        .btn-success:hover {
            background: linear-gradient(135deg, #00a884 0%, var(--success) 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 184, 148, 0.4);
        }

        .loading {
            display: none;
            text-align: center;
            margin: 20px 0;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(108, 92, 231, 0.2);
            border-top: 3px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 12px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .progress-container {
            width: 100%;
            background: rgba(108, 92, 231, 0.1);
            border-radius: 10px;
            margin: 12px 0;
            overflow: hidden;
            display: none;
        }

        .progress-bar {
            height: 6px;
            background: linear-gradient(90deg, var(--primary-light), var(--primary));
            width: 0%;
            transition: width 0.3s ease;
        }

        .output-section {
            display: none;
            margin-top: 20px;
            animation: fadeIn 0.5s ease-out;
        }

        .download-container {
            text-align: center;
            padding: 18px;
            background: rgba(0, 184, 148, 0.05);
            border-radius: var(--border-radius);
            border: 1px dashed var(--success);
        }

        .download-title {
            font-size: 1.1rem;
            margin-bottom: 12px;
            color: var(--dark);
            font-weight: 600;
        }

        .download-subtitle {
            color: var(--gray);
            margin-bottom: 16px;
            font-size: 0.85rem;
        }

        .download-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
        }

        .download-option {
            background: rgba(108, 92, 231, 0.1);
            border-radius: var(--border-radius);
            padding: 10px 12px;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: var(--transition);
            cursor: pointer;
            font-size: 0.85rem;
            min-width: 110px;
            justify-content: center;
        }

        .download-option:hover {
            background: rgba(108, 92, 231, 0.2);
            transform: translateY(-2px);
            box-shadow: var(--shadow-sm);
        }

        .download-option i {
            color: var(--primary);
            font-size: 0.9rem;
        }

        .error-message {
            color: var(--danger);
            background: rgba(214, 48, 49, 0.1);
            padding: 10px 12px;
            border-radius: var(--border-radius);
            margin-bottom: 16px;
            display: none;
            animation: fadeIn 0.3s ease-out;
            font-size: 0.85rem;
        }

        .upload-status {
            display: none;
            text-align: center;
            margin: 10px 0;
            color: var(--primary);
            font-size: 0.85rem;
            font-weight: 500;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .pdf-converter {
                max-width: 95%;
            }
            
            .converter-header {
                padding: 20px 15px;
            }
            
            .converter-header h1 {
                font-size: 1.8rem;
            }
            
            .converter-header p {
                font-size: 0.9rem;
            }
            
            .converter-content {
                padding: 20px;
            }
            
            .upload-area {
                padding: 25px 15px;
            }
            
            .option-item {
                min-width: 100%;
            }

            .preview-image {
                width: 100px;
                height: 140px;
            }

            .action-btns {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
        }

        @media (max-width: 480px) {
            .converter-header h1 {
                font-size: 1.6rem;
            }

            .preview-image {
                width: 80px;
                height: 120px;
            }
        }
    </style>
</head>
<body>
    <div class="pdf-converter">
        <div class="converter-header">
            <h1>PDF to JPG/PNG Converter</h1>
            <p>Convert your PDF pages to high-quality JPG or PNG images quickly and securely. Works entirely in your browser.</p>
        </div>

        <div class="converter-content">
            <div class="error-message" id="error-message"></div>
            
            <div class="upload-area" id="upload-area">
                <i class="fas fa-cloud-upload-alt"></i>
                <h3>Select PDF File</h3>
                <p>Drag & drop your PDF file here or <span class="browse-text">browse</span></p>
                <input type="file" id="file-input" accept=".pdf">
            </div>
            
            <div class="upload-status" id="upload-status"></div>
            
            <div class="options-section">
                <h3 class="options-title">Conversion Options</h3>
                
                <div class="option-group">
                    <div class="option-item">
                        <label for="image-format">Image Format</label>
                        <select id="image-format">
                            <option value="jpg">JPG (Recommended)</option>
                            <option value="png">PNG (Lossless)</option>
                        </select>
                    </div>
                    
                    <div class="option-item">
                        <label for="image-quality">Quality</label>
                        <select id="image-quality">
                            <option value="1">High (Best quality)</option>
                            <option value="0.8" selected>Medium (Good balance)</option>
                            <option value="0.6">Low (Smaller files)</option>
                        </select>
                    </div>
                    
                    <div class="option-item">
                        <label for="dpi">Resolution (DPI)</label>
                        <select id="dpi">
                            <option value="300">300 DPI (High quality)</option>
                            <option value="150" selected>150 DPI (Standard)</option>
                            <option value="72">72 DPI (Web use)</option>
                        </select>
                    </div>
                </div>
                
                <div class="checkbox-option">
                    <input type="checkbox" id="all-pages" checked>
                    <label for="all-pages">Convert all pages</label>
                </div>
                
                <div class="checkbox-option" id="page-range-container" style="display: none;">
                    <input type="checkbox" id="custom-range">
                    <label for="custom-range">Custom page range</label>
                    <input type="text" id="page-range" placeholder="e.g. 1-3,5,7-9" style="width: 120px; margin-left: 10px;">
                </div>
            </div>
            
            <div class="file-preview" id="file-preview">
                <h3 class="preview-title">PDF Preview</h3>
                <div class="preview-container" id="preview-container"></div>
            </div>
            
            <div class="progress-container" id="progress-container">
                <div class="progress-bar" id="progress-bar"></div>
            </div>
            
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>Converting your PDF to images...</p>
            </div>
            
            <div class="action-btns">
                <button class="btn btn-primary" id="convert-btn" disabled>
                    <i class="fas fa-file-image"></i> Convert to Images
                </button>
                <button class="btn btn-secondary" id="clear-btn" disabled>
                    <i class="fas fa-trash-alt"></i> Clear
                </button>
            </div>
            
            <div class="output-section" id="output-section">
                <div class="download-container">
                    <h3 class="download-title">Your images are ready!</h3>
                    <p class="download-subtitle">Download individual images or all as a ZIP archive</p>
                    
                    <div class="download-options">
                        <a href="#" class="download-option" id="download-all-zip">
                            <i class="fas fa-file-archive"></i> Download All (ZIP)
                        </a>
                        <a href="#" class="download-option" id="download-all-jpg">
                            <i class="fas fa-images"></i> Download All
                              </a>

                               <div class="tools-section">
            <a href="/pdf/jpg-to-pdf" class="tool-item">
                <i class="fas fa-file-image"></i> Image to PDF
            </a>
            <a href="/pdf/pdf-to-image" class="tool-item">
                <i class="fas fa-file-pdf"></i> PDF to IMAGE
            </a>
            <a href="/pdf/merge-pdf" class="tool-item">
                <i class="fas fa-object-group"></i> Merge PDF
            </a>
            <a href="/pdf/split-pdf" class="tool-item">
                <i class="fas fa-cut"></i> Split PDF
            </a>
        </div>
    </div>
</div>
<!-- FileSaver.js for saving files --><script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script><!-- PDF.js for rendering PDF previews and conversion --><script src="js/lib/pdf-to-jpg.min.js"></script><!-- JSZip for creating ZIP archives --><script src="js/lib/pdf-to-jpg-jszip.min.js"></script>

    
    <script>
// Set PDF.js worker path
pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.12.313/pdf.worker.min.js';

document.addEventListener('DOMContentLoaded', function() {
    // DOM Elements
    const uploadArea = document.getElementById('upload-area');
    const fileInput = document.getElementById('file-input');
    const convertBtn = document.getElementById('convert-btn');
    const clearBtn = document.getElementById('clear-btn');
    const loading = document.getElementById('loading');
    const errorMessage = document.getElementById('error-message');
    const progressContainer = document.getElementById('progress-container');
    const progressBar = document.getElementById('progress-bar');
    const outputSection = document.getElementById('output-section');
    const uploadStatus = document.getElementById('upload-status');
    const filePreview = document.getElementById('file-preview');
    const previewContainer = document.getElementById('preview-container');
    const allPagesCheckbox = document.getElementById('all-pages');
    const pageRangeContainer = document.getElementById('page-range-container');
    const customRangeCheckbox = document.getElementById('custom-range');
    const pageRangeInput = document.getElementById('page-range');
    const downloadAllZip = document.getElementById('download-all-zip');
    const downloadAllJpg = document.getElementById('download-all-jpg');
    
    // State
    let pdfFile = null;
    let pdfDoc = null;
    let imageUrls = [];
    
    // Handle drag and drop events
    uploadArea.addEventListener('dragover', (e) => {
        e.preventDefault();
        e.stopPropagation();
        uploadArea.classList.add('highlight');
    });
    
    uploadArea.addEventListener('dragleave', (e) => {
        e.preventDefault();
        e.stopPropagation();
        uploadArea.classList.remove('highlight');
    });
    
    uploadArea.addEventListener('drop', (e) => {
        e.preventDefault();
        e.stopPropagation();
        uploadArea.classList.remove('highlight');
        
        if (e.dataTransfer.files.length > 0) {
            const file = e.dataTransfer.files[0];
            if (file.type === 'application/pdf' || file.name.toLowerCase().endsWith('.pdf')) {
                handleFileSelection(file);
            } else {
                showError('Please only upload PDF files.');
            }
        }
    });
    
    // Handle click to select file
    uploadArea.addEventListener('click', () => {
        fileInput.click();
    });
    
    fileInput.addEventListener('change', () => {
        if (fileInput.files.length > 0) {
            const file = fileInput.files[0];
            if (file.type === 'application/pdf' || file.name.toLowerCase().endsWith('.pdf')) {
                handleFileSelection(file);
            } else {
                showError('Please select a PDF file.');
            }
        }
    });
    
    // Toggle page range input
    allPagesCheckbox.addEventListener('change', () => {
        pageRangeContainer.style.display = allPagesCheckbox.checked ? 'none' : 'flex';
    });
    
    customRangeCheckbox.addEventListener('change', () => {
        pageRangeInput.disabled = !customRangeCheckbox.checked;
    });
    
    // Clear button
    clearBtn.addEventListener('click', () => {
        pdfFile = null;
        pdfDoc = null;
        imageUrls = [];
        fileInput.value = '';
        previewContainer.innerHTML = '';
        filePreview.style.display = 'none';
        outputSection.style.display = 'none';
        convertBtn.disabled = true;
        clearBtn.disabled = true;
        hideError();
    });
    
    // Convert button
    convertBtn.addEventListener('click', async () => {
        if (!pdfDoc) {
            showError('Please select a PDF file first.');
            return;
        }
        
        try {
            // UI updates
            loading.style.display = 'block';
            progressContainer.style.display = 'block';
            convertBtn.disabled = true;
            clearBtn.disabled = true;
            hideError();
            
            // Get conversion options
            const format = document.getElementById('image-format').value;
            const quality = parseFloat(document.getElementById('image-quality').value);
            const dpi = parseInt(document.getElementById('dpi').value);
            const scale = dpi / 72; // PDF standard is 72 DPI
            
            // Determine pages to convert
            let pagesToConvert = [];
            const totalPages = pdfDoc.numPages;
            
            if (allPagesCheckbox.checked) {
                // Convert all pages
                pagesToConvert = Array.from({ length: totalPages }, (_, i) => i + 1);
            } else if (customRangeCheckbox.checked && pageRangeInput.value.trim()) {
                // Parse custom page range
                pagesToConvert = parsePageRange(pageRangeInput.value.trim(), totalPages);
            } else {
                // Convert first page only
                pagesToConvert = [1];
            }
            
            if (pagesToConvert.length === 0) {
                showError('No valid pages selected for conversion.');
                throw new Error('No pages selected');
            }
            
            // Clear previous results
            imageUrls = [];
            
            // Process each page
            for (let i = 0; i < pagesToConvert.length; i++) {
                const pageNum = pagesToConvert[i];
                try {
                    const page = await pdfDoc.getPage(pageNum);
                    const viewport = page.getViewport({ scale: scale });
                    
                    // Create canvas for rendering
                    const canvas = document.createElement('canvas');
                    const context = canvas.getContext('2d');
                    canvas.height = viewport.height;
                    canvas.width = viewport.width;
                    
                    // Render PDF page to canvas
                    await page.render({
                        canvasContext: context,
                        viewport: viewport
                    }).promise;
                    
                    // Convert canvas to image
                    let imageUrl;
                    if (format === 'png') {
                        imageUrl = canvas.toDataURL('image/png');
                    } else {
                        imageUrl = canvas.toDataURL('image/jpeg', quality);
                    }
                    
                    imageUrls.push({
                        url: imageUrl,
                        pageNum: pageNum,
                        format: format
                    });
                    
                    // Update progress
                    const progress = Math.round(((i + 1) / pagesToConvert.length) * 100);
                    progressBar.style.width = `${progress}%`;
                    
                } catch (err) {
                    console.error(`Error processing page ${pageNum}:`, err);
                    showError(`Error processing page ${pageNum}. Skipping...`);
                }
            }
            
            // Prepare download options
            if (imageUrls.length > 0) {
                // Single image download
                if (imageUrls.length === 1) {
                    downloadAllJpg.innerHTML = `<i class="fas fa-download"></i> Download ${imageUrls[0].format.toUpperCase()}`;
                    downloadAllJpg.href = imageUrls[0].url;
                    downloadAllJpg.download = `page-${imageUrls[0].pageNum}.${imageUrls[0].format}`;
                    downloadAllZip.style.display = 'none';
                } 
                // Multiple images download
                else {
                    downloadAllJpg.innerHTML = `<i class="fas fa-images"></i> Download All`;
                    downloadAllJpg.style.display = 'flex';
                    downloadAllZip.style.display = 'flex';
                }
                
                // Show output section
                outputSection.style.display = 'block';
                setTimeout(() => {
                    outputSection.scrollIntoView({ behavior: 'smooth' });
                }, 100);
            } else {
                showError('No pages were successfully converted.');
            }
            
        } catch (error) {
            console.error('Error converting PDF:', error);
            if (!errorMessage.textContent) {
                showError('An error occurred while converting the PDF. Please try again.');
            }
        } finally {
            loading.style.display = 'none';
            progressContainer.style.display = 'none';
            progressBar.style.width = '0%';
            convertBtn.disabled = false;
            clearBtn.disabled = false;
        }
    });
    
    // Download all as ZIP
    downloadAllZip.addEventListener('click', async (e) => {
        e.preventDefault();
        
        if (imageUrls.length === 0) return;
        
        try {
            showUploadStatus('Preparing ZIP archive...');
            progressContainer.style.display = 'block';
            
            const zip = new JSZip();
            const imgFolder = zip.folder("pdf_images");
            
            // Add each image to the ZIP
            for (const img of imageUrls) {
                const response = await fetch(img.url);
                const blob = await response.blob();
                imgFolder.file(`page-${img.pageNum}.${img.format}`, blob);
            }
            
            // Generate the ZIP file
            const content = await zip.generateAsync({ type: 'blob' }, (metadata) => {
                const progress = Math.round(metadata.percent);
                progressBar.style.width = `${progress}%`;
            });
            
            // Download the ZIP
            saveAs(content, 'pdf_images.zip');
            
        } catch (error) {
            console.error('Error creating ZIP:', error);
            showError('Error creating ZIP archive. Please try again.');
        } finally {
            progressContainer.style.display = 'none';
            progressBar.style.width = '0%';
        }
    });
    
    // Download all as individual images
    downloadAllJpg.addEventListener('click', (e) => {
        if (imageUrls.length === 0) return;
        
        if (imageUrls.length === 1) {
            // Single download handled by direct link
            return;
        }
        
        e.preventDefault();
        
        // Download each image individually
        imageUrls.forEach(img => {
            const link = document.createElement('a');
            link.href = img.url;
            link.download = `page-${img.pageNum}.${img.format}`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        });
    });
    
    // Helper functions
    function handleFileSelection(file) {
        pdfFile = file;
        showUploadStatus(`Processing ${file.name}...`);
        
        // Read the PDF file
        const fileReader = new FileReader();
        fileReader.onload = async function() {
            try {
                const typedArray = new Uint8Array(this.result);
                
                // Load with PDF.js
                pdfDoc = await pdfjsLib.getDocument(typedArray).promise;
                
                // Create preview
                await createPreview(pdfDoc);
                
                // Enable buttons
                convertBtn.disabled = false;
                clearBtn.disabled = false;
                filePreview.style.display = 'block';
                hideError();
                
            } catch (error) {
                console.error('Error loading PDF:', error);
                showError('Error loading PDF. Please make sure it\'s a valid PDF file.');
            }
        };
        fileReader.onerror = function() {
            showError('Error reading the PDF file. Please try again.');
        };
        fileReader.readAsArrayBuffer(file);
    }
    
    async function createPreview(pdfDoc) {
        previewContainer.innerHTML = '';
        const totalPages = pdfDoc.numPages;
        const pagesToPreview = Math.min(totalPages, 5); // Preview first 5 pages max
        
        for (let i = 1; i <= pagesToPreview; i++) {
            try {
                const page = await pdfDoc.getPage(i);
                const viewport = page.getViewport({ scale: 0.5 });
                
                const canvas = document.createElement('canvas');
                const context = canvas.getContext('2d');
                canvas.height = viewport.height;
                canvas.width = viewport.width;
                
                await page.render({
                    canvasContext: context,
                    viewport: viewport
                }).promise;
                
                const img = document.createElement('img');
                img.src = canvas.toDataURL('image/jpeg', 0.7);
                
                const previewItem = document.createElement('div');
                previewItem.className = 'preview-image';
                previewItem.innerHTML = `
                    <img src="${img.src}" alt="Page ${i}">
                    <div class="page-number">Page ${i}</div>
                `;
                
                previewContainer.appendChild(previewItem);
                
            } catch (error) {
                console.error(`Error rendering page ${i} preview:`, error);
            }
        }
    }

    function parsePageRange(rangeStr, maxPages) {
        const pages = new Set();
        const parts = rangeStr.split(',');
        
        for (const part of parts) {
            if (part.includes('-')) {
                // Handle page ranges (e.g., 1-3)
                const [start, end] = part.split('-').map(Number);
                if (!isNaN(start) && !isNaN(end)) {
                    const realStart = Math.max(1, Math.min(start, maxPages));
                    const realEnd = Math.max(1, Math.min(end, maxPages));
                    for (let i = realStart; i <= realEnd; i++) {
                        pages.add(i);
                    }
                }
            } else if (!isNaN(part)) {
                // Handle single pages
                const pageNum = parseInt(part);
                if (pageNum >= 1 && pageNum <= maxPages) {
                    pages.add(pageNum);
                }
            }
        }
        
        return Array.from(pages).sort((a, b) => a - b);
    }
    
    function showUploadStatus(message) {
        uploadStatus.textContent = message;
        uploadStatus.style.display = 'block';
        setTimeout(() => {
            uploadStatus.style.display = 'none';
        }, 3000);
    }
    
    function showError(message) {
        errorMessage.textContent = message;
        errorMessage.style.display = 'block';
    }
    
    function hideError() {
        errorMessage.style.display = 'none';
    }
});
    </script>
  <script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.12.313/pdf.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
</body>
</html>